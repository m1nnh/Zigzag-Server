## :star: 1ì°¨ ë³´ê³ ì„œ

### EC2 ì„œë²„ êµ¬ì¶•

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2021-05-25 á„‹á…©á„’á…® 1 16 21](https://user-images.githubusercontent.com/78870076/119438737-d0f01280-bd5b-11eb-9e93-8fdedd53ffed.png)

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2021-05-25 á„‹á…©á„’á…® 1 16 37](https://user-images.githubusercontent.com/78870076/119438745-d64d5d00-bd5b-11eb-8f67-f84dc20a5dd3.png)

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2021-05-25 á„‹á…©á„’á…® 1 17 20](https://user-images.githubusercontent.com/78870076/119438752-db121100-bd5b-11eb-843c-07f7c17c0b0b.png)

```
let port;

if (process.env.NODE_ENV === 'development') {
    port = 9000;
} else {
    port = 3000;
}
```

```
const pool = mysql.createPool({
    host: 'minhyeok.cedbpncgweti.ap-northeast-2.rds.amazonaws.com',
    user: 'Id',
    port: '3306',
    password: 'password',
    database: 'zigzag'
});
```

### ERD ì„¤ê³„

https://aquerytool.com:443/aquerymain/index/?rurl=fa883fa1-95f5-4a6d-b868-73dbf33f041b

password : x6b680

### API ì§„í–‰ ìƒí™©

#### :white_check_mark: ì™„ë£Œ API

**íšŒì›ê°€ì… API**

![KakaoTalk_Photo_2021-05-25-13-42-06](https://user-images.githubusercontent.com/78870076/119440326-0ba77a00-bd5f-11eb-887f-f8bde3c4bca3.jpeg)

![KakaoTalk_Photo_2021-05-25-13-42-12](https://user-images.githubusercontent.com/78870076/119440349-182bd280-bd5f-11eb-8404-1f6d80ed426c.jpeg)

- Validation Check
    - Email Empty
    - Email Length
    - Email Regex
    - Password Empty
    - Password Regex
    - PhoneNum Empty
    - PhoneNum Regex
    - SMS Flag Empty
    - SMS Flag regex
    - Email Flag Empty
    - Email Flag Regex

- ëª…ì„¸ì„œ OK ì„œë²„ë°˜ì˜ ì—¬ë¶€ OK

**ë¡œê·¸ì¸ API**

![KakaoTalk_Photo_2021-05-25-13-46-27](https://user-images.githubusercontent.com/78870076/119440627-a3a56380-bd5f-11eb-8ed8-8ca342086608.jpeg)

- Validation Check
    - Email Empty
    - Email Length
    - Email Regex
    - Password Empty
    - Password Length
    - Email Wrong
    - Password Wrong
    - Status Flag Check

- ëª…ì„¸ì„œ OK ì„œë²„ë°˜ì˜ ì—¬ë¶€ OK

**íšŒì› ì •ë³´ ìˆ˜ì •API**

![KakaoTalk_Photo_2021-05-25-13-48-27](https://user-images.githubusercontent.com/78870076/119440766-e49d7800-bd5f-11eb-83e9-456396f01cf3.jpeg)

- Validation Check
    - User Id Empty
    - User Id Not Match
    - User Id Not Exist
    - Name Empty
    - Name Regex
    - PhoneNum Regex

- ëª…ì„¸ì„œ OK ì„œë²„ë°˜ì˜ ì—¬ë¶€ OK

**íŠ¹ì´ì‚¬í•­**

```
if (userName.length > 0 & userPhoneNum.length > 0) {
    if (!regUserName.test(userName))
        return res.send(errResponse(baseResponse.NAME_ERROR_TYPE)); // 2022 : ì´ë¦„ì„ í˜•ì‹ì— ë§ê²Œ ì…ë ¥í•´ì£¼ì„¸ìš”

    else if (!regPhoneNum.test(userPhoneNum))   
        return res.send(errResponse(baseResponse.SIGNUP_PHONE_ERROR_TYPE)); // 2007 : íœ´ëŒ€í° ë²ˆí˜¸ í˜•ì‹ì— ë§ì¶° ì…ë ¥í•´ì£¼ì„¸ìš”. ex) 01012341234
                                                                            
    else {
        const editUserInfo = await userService.editUser(userPhoneNum, userName, userIdx); // Patch All
        return res.send(response(baseResponse.SUCCESS, editUserInfo.info));
    }
}

if (userName.length > 0) {
    if (!regUserName.test(userName))
        return res.send(errResponse(baseResponse.NAME_ERROR_TYPE)); // 2022 : ì´ë¦„ì„ í˜•ì‹ì— ë§ê²Œ ì…ë ¥í•´ì£¼ì„¸ìš”

    else {
        const editName = await userService.editName(userIdx, userName); // Patch Name
        return res.send(response(baseResponse.SUCCESS, editName.info)); 
    }
}

if (userPhoneNum.length > 0) {
    if (!regPhoneNum.test(userPhoneNum))
        return res.send(errResponse(baseResponse.SIGNUP_PHONE_ERROR_TYPE)) // 2007 : íœ´ëŒ€í° ë²ˆí˜¸ í˜•ì‹ì— ë§ì¶° ì…ë ¥í•´ì£¼ì„¸ìš”. ex) 01012341234

    else {
        const editPhoneNum = await userService.editPhoneNum(userIdx, userPhoneNum); // Patch PhoneNum
        return res.send(response(baseResponse.SUCCESS, editPhoneNum.info));
        }
}
```

#### ğŸ“ ì§„í–‰ì¤‘ì¸ API

**í™ˆ ìƒí’ˆ ì¡°íšŒ API**
![KakaoTalk_Photo_2021-05-25-13-53-55](https://user-images.githubusercontent.com/78870076/119441191-abb1d300-bd60-11eb-8e05-d174d1ae5ab4.jpeg)

```
// Result
    let homeResult = await productProvider.homeProduct(page, size);
    let getLikeProductStatus = await productProvider.likeProductStatus(userIdx);

    for (var i = 0; i < homeResult.length; i++) {
        var flag = 0;
        for (var j = 0; j < getLikeProductStatus.length; j++) {
            if (homeResult[i].productIdx === getLikeProductStatus[j].productIdx) {
                homeResult[i]["likeProductStatus"] = getLikeProductStatus[j].status;
                flag = 1;
                break;
            }
        }
        if (flag === 0)
            homeResult[i]["likeProductStatus"] = 'N';
    }
```

- ìš°ì„  í™ˆìƒí’ˆì— ëŒ€í•œ Resultë¥¼ ë½‘ëŠ”ë‹¤.
- ê·¸ë¦¬ê³  ë‚˜ì„œ ìœ ì €ì˜ ìƒí’ˆì— ëŒ€í•œ statusë¥¼ ë½‘ì€ í›„ ê°’ì´ ì¡´ì¬í•˜ëŠ” ê²ƒì—ëŠ” í•´ë‹¹ ìƒí’ˆì— ëŒ€í•œ statusë¥¼ ë„£ì–´ì£¼ê³ , ì—†ëŠ” ê²½ìš° 'N'ìœ¼ë¡œ ì²˜ë¦¬
- ê°ê°ì˜ í˜ì´ì§• ì²˜ë¦¬ ì™„ë£Œ
- ë°¸ë¦¬ë°ì´ì…˜ ì™„ë£Œ
- ì¶”ì²œì‹œìŠ¤í…œ -> ëœë¤ìœ¼ë¡œ ì ìš©

<img width="920" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2021-05-25 á„‹á…©á„’á…® 1 57 35" src="https://user-images.githubusercontent.com/78870076/119441494-2d096580-bd61-11eb-8792-66c834238a65.png">

**ë¸Œëœë“œ ìƒí’ˆ ì¡°íšŒ API**

![KakaoTalk_Photo_2021-05-25-13-56-40](https://user-images.githubusercontent.com/78870076/119441612-5fb35e00-bd61-11eb-9634-b877255a00db.jpeg)

- ìœ„ì˜ ê²°ê³¼ì™€ ë™ì¼

**ë­í‚¹ë³„ ë¸Œëœë“œ ìƒí’ˆ ì¡°íšŒ API**

![KakaoTalk_Photo_2021-05-25-13-59-43](https://user-images.githubusercontent.com/78870076/119441672-78bc0f00-bd61-11eb-9b70-0da0d8876bf8.jpeg)

```
for (var i = 0; i < rankResult.length; i++) {
        var flag = 0;
        for (var j = 0; j < bookMarkStatus.length; j++) {
            if (rankResult[i].brandIdx === bookMarkStatus[j].brandIdx) {
                rankResult[i]["bookMarkStatus"] = bookMarkStatus[j].status;
                flag = 1;
                break;
            }
        }
        if (flag === 0)
            rankResult[i]["bookMarkStatus"] = 'N';
    }

    for (var i = 0; i < 3; i++) {
        if (i >= rankResult.length )
            break;
        var brandProductResult = await productProvider.brandRankProduct(rankResult[i].brandIdx);
        rankResult[i]["product"] = brandProductResult;
    }
```

- ì²« ë²ˆì§¸ë¡œ í•„í„°ë§ì„ ê±°ì¹œ ë­í‚¹ì„ ë½‘ì•„ë‚¸ë‹¤. (í•„í„°ë§ ì²˜ë¦¬ ì™„ë£Œ)
- ë‘ ë²ˆì§¸ë¡œ í•´ë‹¹ ë¸Œëœë“œê°€ ìœ ì €ì˜ ë¶ë§ˆí¬ ìƒíƒœë¥¼ ë½‘ì•„ë‚¸ë‹¤.
- ì„¸ ë²ˆì§¸ë¡œ í•´ë‹¹ ë¸Œëœë“œì— ì†í•´ìˆëŠ” ìƒí’ˆ 20ê°œë¥¼ ê°€ì ¸ì˜¨ë‹¤.
- ë²¨ë¦¬ë°ì´ì…˜ ì²˜ë¦¬ ì™„ë£Œ

**ë² ìŠ¤íŠ¸ ìƒí’ˆ ì¡°íšŒ API**

![KakaoTalk_Photo_2021-05-25-14-01-47](https://user-images.githubusercontent.com/78870076/119441841-c5074f00-bd61-11eb-9be7-a5ebb33b6e3a.jpeg)

- ìœ„ì— í™ˆê³¼, ë¸Œëœë“œ ìƒí’ˆ ì¡°íšŒì™€ ë™ì¼
- ì¶”ê°€ë˜ëŠ” ê²ƒì€ í•„í„°ë§ ì¡°ê±´
- ì¹´í…Œê³ ë¦¬ í•„í„°ë§, ì—°ë ¹ëŒ€ í•„í„°ë§ ì¶”ê°€ì˜ˆì •

### API ì„¤ê³„ ì§„í–‰ ì˜ˆì •

- ì´ë²ˆì£¼ ê¸ˆìš”ì¼ê¹Œì§€ í˜œíƒ ë° ì‹ ìƒí’ˆ ì¡°íšŒ ë° íŠ¹ì • ìƒí’ˆ ì¡°íšŒ ì„¤ê³„
- ì£¼ë§ì— ê²€ìƒ‰ ê´€ë ¨ API ì„¤ê³„
- ë‹¤ìŒì£¼ ~ ë¯¸ì •

### API ëª…ì„¸ì„œ

https://drive.google.com/file/d/1b3dae6raasmNYAIuMawvpVDnbHRvbKur/view?usp=sharing

